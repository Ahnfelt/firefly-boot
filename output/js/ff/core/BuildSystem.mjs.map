{
    "version": 3,
    "sources": [
        "../../../../core/BuildSystem.ff"
    ],
    "sourcesContent": [
        "capability BuildSystem {}\n\nextend self: BuildSystem {\n\n    compileForBrowser(mainFiles: List[String]): AssetSystem {\n        // TODO: Check that the mainFile is in the current package directory\n        internalCompile(self, mainFiles.map {internalPath(self, _)}, \"browser\")\n        let streams = internalListDirectory(internalPath(self, \".firefly/output/browser\"))\n        let mainPackagePair = internalMainPackagePair(self)\n        AssetSystem(streams.toMap())\n    }\n\n    bundleForBrowser(mainFiles: List[String], minify: Bool = True, sourceMaps: Bool = False): AssetSystem {\n        internalCompile(self, mainFiles.map {internalPath(self, _)}, \"browser\")\n        let browserOutputPath = internalPath(self, \".firefly/output/browser\")\n        let runPaths = internalListPath(browserOutputPath).filter {_.base().endsWith(\".run.mjs\")}.toList()\n        let outputPath = runPaths.grabFirst().parent().grab()\n        //let start = self.mainTask().elapsed()\n        internalBrowserCallEsBuild(self, runPaths.map {_.absolute()}, outputPath.absolute(), minify, sourceMaps)\n        //Log.debug(runPaths.map {_.absolute()}.join(\" \") + \": \" + Show.show(Duration(self.mainTask().elapsed().seconds - start.seconds)))\n        let bundlePaths = internalListPath(browserOutputPath).filter {p => \n            p.base().endsWith(\".bundle.js\") || p.base().endsWith(\".bundle.js.map\")\n        }.toList()\n        AssetSystem(bundlePaths.map {p => \n            Pair(\"/\" + p.relativeTo(browserOutputPath).replace(\"\\\\\", \"/\"), {p.readStream()})\n        }.toMap())\n    }\n\n    buildMode(): Bool {\n        !!self!->\"buildMode_\"?\n    }\n    \n    setAssets(assetSystem: AssetSystem): Unit {\n        self!->\"assets_\" = assetSystem!\n    }\n\n    packageAssets(): AssetSystem {\n        let streams = internalListDirectory(internalPath(self, \".\"))\n        AssetSystem(streams.toMap())\n    }\n\n    dependencyAssets(user: String, package: String): AssetSystem {\n        panic(\"dependencyAssets not yet implemented\")\n    }\n\n    arguments(): List[String] {\n        self!->\"array_\"?\n    }\n\n    mainTask(): Task {\n        self!->\"task_\"?\n    }\n\n    crypto(): Crypto {\n        Js->crypto?\n    }\n        \n}\n\ninternalBrowserCallEsBuild(\n    self: BuildSystem\n    mainJsFiles: List[String]\n    outputPath: String\n    minify: Bool\n    sourceMap: Bool\n): Unit {\n    let esbuild = Js.import(\"esbuild\")\n    Js.await(esbuild->build(Js->(\n        entryPoints = mainJsFiles\n        bundle = True\n        minify = minify\n        sourcemap = sourceMap\n        platform = \"browser\"\n        target = \"es2017\"\n        outdir = outputPath\n        outExtension = Js.object().with(\".js\", \".bundle.js\")\n    )))\n}\n\ninternalNodeCallEsBuild(\n    self: NodeSystem\n    mainJsFile: String\n    outputPath: String\n    minify: Bool\n): Unit {\n    let esbuild = Js.import(\"esbuild\")\n    Js.await(esbuild->build(Js->(\n        entryPoints = [mainJsFile]\n        bundle = True\n        minify = minify\n        sourcemap = True\n        platform = \"node\"\n        target = \"es2017\"\n        external = [\"esbuild\", \"uws.js\"] // [\"esbuild\", \"*.node\"] // [\"*/node_modules\"] // TODO [\"esbuild\", \"*.node\"]\n        loader = Js.object().with(\".node\", \"copy\")\n        outfile = outputPath\n    )))    \n}\n\ninternalListDirectory(path: Path): List[Pair[String, () => Stream[Buffer]]] {\n    function go(currentPath: Path): Stream[Path] {\n        currentPath.entries().flatMap {file =>\n            if(file.isDirectory()) {\n                go(file.path())\n            } else {\n                [file.path()].toStream()\n            }\n        }\n    }\n    go(path).map {file =>\n        Pair(\"/\" + file.relativeTo(path).replace(\"\\\\\", \"/\"), {file.readStream()})\n    }.toList()\n}\n\ninternalListPath(path: Path): Stream[Path] {\n    path.entries().flatMap {file =>\n        if(file.isDirectory()) {\n            internalListPath(file.path())\n        } else {\n            [file.path()].toStream()\n        }\n    }\n}\n\ninternalPath(buildSystem: BuildSystem, absoluteOrRelative: String): Path {\n    let nodePath = Js.import(\"path\")\n    Path(nodePath->resolve(absoluteOrRelative)?)\n}\n\ninternalCompile(buildSystem: BuildSystem, mainFiles: List[Path], target: String): Unit {\n    if(Js.globalThis()->ffDevelopMode.typeof() != \"undefined\") {\n        Js->process->send(Js->(\n            ffDevelopMode = \"internalCompile\"\n            mainFiles = mainFiles.map {_.absolute()}\n            target = target\n        ))\n        Js.awaitCancellablePromise {resolve, reject, cleanup =>\n            Js->process->on(\"message\", Js->{message => \n                if(message->ffDevelopMode === \"internalCompile\") {\n                    resolve(Unit) // Handle errors?\n                }\n            })\n        }\n    } else:\n    // Ported from the old FFI. It's quite fragile w.r.t. changes in code generation.\n    Js.await(Js.rawIdentifier(\"$firefly_compiler\")->\"buildViaBuildSystem_$\"(\n        buildSystem! \n        internalPath(buildSystem, buildSystem!->\"fireflyPath_\"?)!\n        mainFiles!\n        target\n        Js.undefined()\n        Js.undefined()\n        Js.currentTask()!\n    ))\n}\n\ninternalMainPackagePair(buildSystem: BuildSystem): Pair[String, String] {\n    Pair(buildSystem!->\"mainPackagePair_\"->\"group_\"?, buildSystem!->\"mainPackagePair_\"->\"name_\"?)\n}\n"
    ],
    "names": [
        "internalBrowserCallEsBuild",
        "self",
        "mainJsFiles",
        "outputPath",
        "minify",
        "sourceMap",
        "esbuild",
        "build",
        "entryPoints",
        "bundle",
        "sourcemap",
        "platform",
        "target",
        "outdir",
        "outExtension",
        "internalNodeCallEsBuild",
        "mainJsFile",
        "external",
        "loader",
        "outfile",
        "internalListDirectory",
        "path",
        "go",
        "currentPath",
        "flatMap",
        "entries",
        "file",
        "isDirectory",
        "toStream",
        "toList",
        "map",
        "Pair",
        "replace",
        "relativeTo",
        "readStream",
        "internalListPath",
        "internalPath",
        "buildSystem",
        "absoluteOrRelative",
        "nodePath",
        "Path",
        "resolve",
        "internalCompile",
        "mainFiles",
        "ffDevelopMode",
        "\"process\"",
        "send",
        "w1",
        "absolute",
        "awaitCancellablePromise",
        "reject",
        "cleanup",
        "on",
        "message",
        "internalMainPackagePair",
        "compileForBrowser",
        "streams",
        "mainPackagePair",
        "AssetSystem",
        "toMap",
        "bundleForBrowser",
        "sourceMaps",
        "browserOutputPath",
        "runPaths",
        "filter",
        "endsWith",
        "base",
        "grab",
        "parent",
        "grabFirst",
        "bundlePaths",
        "p",
        "buildMode",
        "setAssets",
        "assetSystem",
        "packageAssets",
        "dependencyAssets",
        "user",
        "package",
        "panic",
        "arguments",
        "mainTask",
        "crypto",
        "\"crypto\""
    ],
    "mappings": "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"
}